library(tm)
files <- list.files(pattern = "pdf$")

Rpdf <- readPDF(control = list(text = "-layout"))

opinions <- Corpus(URISource(files), 
                   readerControl = list(reader = Rpdf))


my_stopwords <- c(stopwords('french'))
my_stopwords <- my_stopwords[-which(my_stopwords %in% c("j", "je", "moi"))]


opinions.tdm <- TermDocumentMatrix(opinions, control = list(removePunctuation = TRUE,
                                                            #stopwords = my_stopwords,
                                                            stopwords=FALSE,
                                                            tolower = TRUE,
                                                            stemming = FALSE,
                                                            removeNumbers = TRUE,
                                                            bounds = list(global = c(1, Inf))))


inspect(opinions.tdm)
ft <- findFreqTerms(opinions.tdm, lowfreq = 20, highfreq = Inf)

toto <- inspect(opinions.tdm)
colnames(toto) <- c("Avenel","Malin", "Karcher")

write.csv(toto, file = "mots.csv")


ae.tdm <- DocumentTermMatrix(opinions, control = list(minWordLength = 1))
inspect(ae.tdm)


library(wordcloud)

term.matrix <- as.matrix(opinions.tdm)
colnames(term.matrix) <- c("Avenel","Malin", "Karcher")

png("wordcloud_prof.png", width=800,height=800, res = 160)
comparison.cloud(term.matrix,min.freq=20,
                 random.order=FALSE)
dev.off()

